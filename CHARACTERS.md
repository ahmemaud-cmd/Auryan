# إضافة شخصيات لـ Orian

كل شخصية موجودة تحت `images/characters/` ويمكن أن تحتوي على: `skins` (ألوان البشرة/مظهر أساسي) و`outfits` (لبس يمكن أن يكون مؤقتًا).

مثال `meta.json`:

{
  "characters": [
    {
      "id": "boy",
      "name": "ولد",
      "skins": [
        { "id": "light", "name": "فاتح", "img": "images/characters/boy_skin_light.svg" }
      ],
      "outfits": [
        { "id": "jacket", "name": "جاكيت", "img": "images/characters/boy_outfit_jacket.svg", "duration": 3600 }
      ]
    }
  ]
}

قواعد سريعة:
- `id` معرف فريد يُستخدم لمزامنة اللاعب مع السيرفر.
- `num` (اختياري) رقم ثابت مميز لكل شخصية — يمكن استخدام أرقام كبيرة (مثلاً `1111111111`) للربط مع إعدادات الأدمن. إذا لم يُحدد `num` سيُعطى رقم تلقائي (1-based).
- `hideFromSelection` (اختياري) — إذا كانت `true` فلن تظهر الشخصية في واجهة اختيار اللاعب (مفيدة لشخصية الأدمن).
- `skins` مصفوفة من نسخ الـ base (يجب أن تحوي `id`,`name`,`img`).
- `outfits` مصفوفة من طبقات (overlay) يمكن أن تحتوي `duration` بالثواني (إن وُجدت سيصبح اللبس مؤقتًا وينتهي تلقائيًا عند انتهاء المدة).
- عند الانضمام، يختار اللاعب `character` و`skin` و`outfit` مرة واحدة؛ اللبس (إن كان مؤقتًا) سيزول تلقائيًا بعد انتهاء المدة على السيرفر.

الخطوات لإضافة skin أو outfit:
1. ضع ملف الصورة داخل `images/characters/` (يفضّل SVG لتسهيل التلوين/التحجيم).
2. أضف عنصرًا داخل `skins` أو `outfits` للشخصية داخل `images/characters/meta.json` مع المسار والـ `id` و`name`، وإذا كان اللبس مؤقتًا أضف `"duration": عدد_الثواني`.
3. يمكنك أيضًا إضافة صورة خلفية للخريطة وإعداد نقاط الظهور في `images/map.json`، مثال:

{
  "bg": "images/auryan_png.png",
  "spawns": [ { "id":"spawn_1", "x":160, "y":220 }, { "id":"spawn_2", "x":240, "y":220 } ],
  "chairs": [ ... ]
}

ضع صورة الخلفية (`auryan_png.png`) داخل `images/` بنفس الاسم ليظهر تلقائيًا عند تحميل الخريطة.

### حفظ ملفات المستخدمين (بسيط، محلي)
- يتم الآن حفظ بيانات المستخدم (الاسم الأول، الكنية، الجنس، الشخصية، skin، outfit) في ملف JSON محلي `data/users.json` عندما ينضم اللاعب لأول مرة.
- يمكنك استرجاع أو تحديث ملف المستخدم عبر الواجهات البسيطة:
  - GET `/users/:username` — جلب بيانات المستخدم
  - POST `/users/:username` — تحديث بيانات المستخدم (راسل البنية `{ "firstName":"...", "lastName":"..." }`)

4. أعد تحميل الصفحة، وستظهر الخلفية ونقاط الظهور والكراسي تلقائيًا.
ملاحظات تقنية:
- السيرفر يتحقق دوريًا من انتهاء مدة اللباس ويُخبر العملاء بتحديث حالة اللاعب (حدث `player:updated`).
- حالياً لا يسمح بتبديل اللبس بعد الانضمام إلا داخل اللعبة (آلية الشراء/الإيجار يمكن تنفيذها لاحقًا).
